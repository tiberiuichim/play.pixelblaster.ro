+++
draft = false
date = "2006-09-20T12:35:28-03:00"
title = "Basic recipe for a Five view"
tags = ["cookbook", "Plone"]
created = "2006-09-20T11:54:14-03:00"
modified = "2006-10-06T16:21:50-03:00"
permaLink = "http://play.pixelblaster.ro/blog/archive/2006/09/20/basic-recipe-for-a-five-view"
author = "Tiberiu Ichim"
aliases = [
    "/blog/archive/2006/09/20/basic-recipe-for-a-five-view"
]
+++

<p>This recipe is addressed more to the zope2/plone developer with a bit of knowledge of the zope3 universe, but not much experience in implementing the new practices.</p><p>Simply put, Five views are just like TTW python scripts, except without the limited forced security, and with the possibility to integrate them in unit testing and adapt them to other protocols then just http.<br /></p><p>First, things should be done the <a href="http://plone.org/documentation/manual/plone-developer-reference/patterns/future-proofing" target="_self">newly recommended "Zope3 ways"</a>. That means creating a new package under the Products folder, or, if <a href="http://plone.org/products/pythonproducts" target="_self">pythonproducts</a> is used, anywhere in the python packages path.<br /></p><p>Let's name this package "views_test". Make it a python package by placing an empty __init__.py file inside. We'll place the views under a 'browser' package, so we need to create a new folder called 'browser' with an empty __init__.py file as well. <br /></p><p>Inside the browser package, we'll create a 'testing' module, with the following content:</p><pre>from zope.interface import Interface, implements<br />from Products.CMFPlone import utils<br /><br />class ITesting(Interface):<br />    def drink():<br />        """Drinks the cool aid"""<br /><br />class Testing(utils.BrowserView):<br />    implements(ITesting)<br /><br />    def drink(self):<br />        context=utils.context(self)<br />        portal_url = context.portal_url()<br />        return "We drank the cool aid at %s" % portal_url</pre><p>The interface declaration is not needed, and it's not necesary for the view to implement a certain interface, but it makes documenting, configuring and possibly future extending the software easier.<br /></p><h3>Configuring zope to load the view</h3><p>Best practices is to place configuration files (configure.zcml) in the closest package to which they belong, so we'll have to configure zope to look in the 'browser' package for zcmls as well. To do this, edit the views_test/configure.zcml file and place a simple directive to load the browser package.</p><pre>&lt;include package=".browser" /&gt;</pre>The configure.zcml file for the browser package will contain<br /><pre>&lt;configure xmlns="http://namespaces.zope.org/zope"<br />           xmlns:browser="http://namespaces.zope.org/browser"<br />          xmlns:five="http://namespaces.zope.org/five"&gt;<br /><br />  &lt;browser:page<br />    for="*"<br />    name="testing_view"<br />    class=".testing.Testing"<br />    permission="zope.Public"<br />    template="testview"<br />    allowed_interface=".testing.ITesting"<br />    allowed_attributes="drink"<br />    /&gt;<br /><br />&lt;/configure&gt;<br /></pre><p>The TAL template, testview.pt is like this:</p><pre>&lt;html&gt;<br />  &lt;head&gt;<br />    &lt;title tal:content="template/title"&gt;The title&lt;/title&gt;<br />  &lt;/head&gt;<br />  &lt;body tal:define="view context/@@testing_view"&gt;<br />    &lt;span tal:content="view/drink" /&gt;<br />  &lt;/body&gt;<br />&lt;/html&gt;<br /></pre><p>It doesn't use the standard main_template macros, but this can be easily integrated.<br /></p>
