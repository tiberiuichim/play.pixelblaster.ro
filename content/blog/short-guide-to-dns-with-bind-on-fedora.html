+++
draft = false
date = "2006-08-23T09:40:13-03:00"
title = "Short guide to dns with bind on Fedora"
tags = ["cookbook", "Linux"]
created = "2006-08-23T08:59:47-03:00"
modified = "2006-08-23T09:40:13-03:00"
permaLink = "http://play.pixelblaster.ro/blog/archive/2006/08/23/short-guide-to-dns-with-bind-on-fedora"
author = "Tiberiu Ichim"
aliases = [
    "/blog/archive/2006/08/23/short-guide-to-dns-with-bind-on-fedora"
]
+++

<p>I'm replacing a tinydns server with bind9, so I may as well put the setup here, as future reference.</p><p>First,</p><pre>yum install bind-chroot<br /></pre><p>to install the chrooted bind server.</p><p>Next, edit the /var/named/chroot/etc/named.conf</p><pre>options {<br />        directory "/var/named";<br />        dump-file "/var/named/data/cache_dump.db";<br />        statistics-file "/var/named/data/named_stats.txt";<br />        recursion no;<br />};<br />//root global<br />//life<br />zone "life.org.ro" {<br />    type master;<br />    file "/etc/db.life.org.ro";<br />    notify yes;<br />};<br />zone "0.0.127.in-addr.arpa" {<br />    type master;<br />    file "/etc/db.localhost";<br />    allow-update { none; };<br />};<br />zone "58.77.82.in-addr.arpa" {<br />    type master;<br />    file "/etc/db.82.77.58.133";<br />};<br />zone "caleidoscop.org.ro" {<br />    type master;<br />    file "/etc/db.caleidoscop.org.ro";<br />    notify yes;<br />};<br /><br />include "/etc/rndc.key";<br /></pre><p>I'm defining four zones: life.org.ro, reverse localhost (127.0.0.1), reverse dns for the IP and an extra host, caleidoscop.org.ro.</p><p>Now, the content of db.life.org.ro</p><p></p><p></p><pre>$TTL 86400<br />life.org.ro. IN  SOA  a.ns.life.org.ro. hostmaster.life.org.ro (<br />   2006082102   ; serial<br />   1h   ; refresh<br />   15m  ; retry<br />   15d  ; expire<br />   1h ) ; negative caching<br />; NAMESERVER<br />life.org.ro. IN NS a.ns.life.org.ro.    ; nameserver<br />;<br />; hosts (canonical names)<br />;<br />life.org.ro.            IN A  82.77.58.133<br />a.ns.life.org.ro.       IN A  82.77.58.133<br />mail.life.org.ro.       IN A  82.77.58.133<br />www.life.org.ro.        IN A  82.77.58.133<br />;<br />; mail exchanger<br />;<br />life.org.ro.    IN MX 10 mail.life.org.ro.<br />; SPF records<br />life.org.ro.         IN TXT "v=spf1 a mx ~all"<br />mail.life.org.ro.    IN TXT "v=spf1 a mx -all"</pre><p>The domain is registered at RNC (Romanian central dns registry) with 82.77.58.133 a.ns.life.org.ro, so I'm setting a.ns.life.org.ro as the authoritative nameserver in line 2, then define the nameserver, the hosts, mail exchanger and the SPF records (thanks to the <a href="http://openspf.org" target="_self">http://openspf.org</a> wizard). The server in itself has only one internet connection, with only one IP address, (no redundancies), so I've just defined one nameserver.<br /></p><p>Next, the reverse IP entry for 82.77.58.133, in db.82.77.58.133</p><pre>$TTL 3h<br />58.77.82.in-addr.arpa. IN  SOA  a.ns.life.org.ro. hostmaster.life.org.ro (<br />   1    ; serial<br />   1h   ; refresh<br />   15m  ; retry<br />   30d  ; expire<br />   1h ) ; negative caching<br /><br />; NAMESERVER<br />58.77.82.in-addr.arpa. IN NS a.ns.life.org.ro.  ; nameserver<br />;<br />; hosts (canonical names)<br />;<br />133.58.77.82.in-addr.arpa.      IN PTR    life.org.ro.<br /></pre><p>Just added a PTR record for life.org.ro</p><p>Now, the file db.caleidoscop.org.ro. I've defined the host, primary name server and SPF record.<br /></p><p></p><pre>$TTL 86400<br />caleidoscop.org.ro. IN  SOA  a.ns.life.org.ro. hostmaster.caleidoscop.org.ro (<br />   1    ; serial<br />   1h   ; refresh<br />   15m  ; retry<br />   30d  ; expire<br />   1h ) ; negative caching<br /><br />;<br />; hosts (canonical names)<br />;<br />caleidoscop.org.ro.       IN A  82.77.58.133<br />www.caleidoscop.org.ro.       IN A  82.77.58.133<br />;<br />; Aliases<br />;<br />;mail.life.org.ro.    IN CNAME server.life.org.ro.<br />;<br />; mail exchanger<br />;<br />caleidoscop.org.ro.    IN MX 10 mail.life.org.ro.<br />; SPF record<br />caleidoscop.org.ro. IN TXT "v=spf1 a mx ~all"</pre><p>Finally, the entry for db.localhost</p><pre>$TTL 3h<br />0.0.127.in-addr.arpa. IN SOA a.ns.life.org.ro. hostmaster.life.org.ro. (<br />                          1        ; Serial<br />                          3h       ; Refresh after 3 hours<br />                          1h       ; Retry after 1 hour<br />                          1w       ; Expire after 1 week<br />                          1h )     ; Negative caching TTL of 1 hour<br /><br />0.0.127.in-addr.arpa.  IN NS  a.ns.life.org.ro.<br />1.0.0.127.in-addr.arpa.  IN PTR localhost.</pre><p>That's about it. I may have made some mistakes, but checking the domains with <a href="http://dnsreport.com" target="_self">dnsreport </a>yields good reports, so I'll leave it like this.<br /></p>
