+++
draft = false
date = "2006-08-23T15:33:47-03:00"
title = "Creating and managing a Windows service (part 2)"
keywords = "Python, cookbook"
created = "2006-08-23T15:29:31-03:00"
modified = "2006-08-23T16:45:33-03:00"
permaLink = "http://play.pixelblaster.ro/blog/archive/2006/08/23/creating-and-managing-a-windows-service-part-2"
author = "Tiberiu Ichim"
+++

This part of the recipe shows the python code needed to create (install) the Windows service. I didn't write most of this, I just found it somewhere on the internet. Credit due to the original author.<br /><pre>import sys<br />import win32service, win32serviceutil<br /><br />from config import SERVICE_NAME, SERVICE_DISPLAY_NAME, SOFTWAREPATH<br />service_path = "%s\myservice.exe" % SOFTWAREPATH<br /><br />def debug(msg):<br />    print msg<br />    <br />def removeSvc():<br />    debug('called removeSvc()')<br />    win32serviceutil.RemoveService(SERVICE_NAME)<br />    debug('...service was removed')<br />    <br />def installSvc():<br />    debug('installSvc()')<br />    hscm = win32service.OpenSCManager(None,None,win32service.SC_MANAGER_ALL_ACCESS)<br />    debug('...opened svc manager')<br />    try:<br />        try:<br />            hs = win32service.CreateService(hscm,<br />                                            SERVICE_NAME,<br />                                            SERVICE_DISPLAY_NAME,<br />                                            win32service.SERVICE_ALL_ACCESS,         # desired access<br />                                            win32service.SERVICE_WIN32_OWN_PROCESS,  # service type<br />                                            win32service.SERVICE_DEMAND_START,<br />                                            win32service.SERVICE_ERROR_NORMAL,      # error control type<br />                                            service_path,<br />                                            None,<br />                                            0,<br />                                            None,<br />                                            None,<br />                                            None)<br />            debug('...installed service')<br />            win32service.CloseServiceHandle(hs)<br />        except:<br />            debug('...failed to install service')<br />            debug('...%s' % sys.exc_info()[0])<br />            debug('...%s' % sys.exc_info()[1])<br />    finally:<br />        debug('...closing service handle')<br />        win32service.CloseServiceHandle(hscm)<br />        <br />if __name__ == "__main__":<br />    installSvc()<br />    raw_input('Press &lt;ENTER&gt; to continue...')</pre><p>To delete the service, use this code:</p><pre>import sys<br />import win32service, win32serviceutil<br /><br />from config import SERVICE_NAME, SERVICE_DISPLAY_NAME<br /><br />def debug(msg):<br />    print msg<br /><br />def removeSvc():<br />    debug('called removeSvc()')<br />    win32serviceutil.RemoveService(SERVICE_NAME)<br />    debug('...service was removed')<br /><br />if __name__ == "__main__":<br />    removeSvc()<br />    raw_input('Press &lt;ENTER&gt; to continue...')</pre><p>Next, how to start/stop/set startup for this service.<br /></p>
