+++
draft = false
date = "2006-09-06T16:48:34-03:00"
title = "Printing frameworks and wxPython"
keywords = "Python, Windows, cookbook"
created = "2006-09-06T16:23:56-03:00"
modified = "2006-09-06T16:51:43-03:00"
permaLink = "http://play.pixelblaster.ro/blog/archive/2006/09/06/printing-frameworks-and-wxpython"
author = "Tiberiu Ichim"
+++

<p>As hard as I have tried to find, there's no good printing framework for wxPython. wxEasyPrinting sucks so much for anything more then simple text (for example, the table cells don't support specifying a height). Generating PDF files with a toolkit such as ReportLab (even with Platypus) is harder then it should be, especially when there's no ready made higher level framework. <a href="http://tgolden.sc.sabren.com/python/win32_how_do_i/print.html" target="_self">This page explores some of the common printing solutions on Windows</a>.<br /></p><p>My own solution to all these is a single-platform hack. Based on my previous experience of creating a "zope based desktop application" using an embeded Internet Explorer, I'm using Internet Explorer through ActiveX as a rendering and print preview engine. Building a new "form" is easy with any HTML GUI builder such as NVU or Dreamweaver and SimpleTAL bridges the gap between the application data and the presentation for printing. The trick is to display only the Print Preview dialog, which can't be done without going through Internet Explorer's back door.<br /></p><p>In my generated HTML files I have the following snippet, which automatically calls the Print Preview dialog from Internet Explorer when the file is loaded.<br /></p><pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;<br />&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;<br />&lt;head&gt;<br />&lt;script&gt;<br />function printpr()<br />{<br />var OLECMDID = 7;<br />/* OLECMDID values:<br />* 6 - print<br />* 7 - print preview<br />* 1 - open window<br />* 4 - Save As<br />*/<br />var PROMPT = 1; // 2 DONTPROMPTUSER <br />var WebBrowser = "&lt;OBJECT ID='WebBrowser1' WIDTH=0 HEIGHT=0 CLASSID='CLSID:8856F961-340A-11D0-A96B-00C04FD705A2' /&gt;";<br />document.body.insertAdjacentHTML('beforeEnd', WebBrowser); <br />WebBrowser1.ExecWB(OLECMDID, PROMPT);<br />WebBrowser1.outerHTML = "";<br />}<br />&lt;/script&gt;<br />&lt;/head&gt;<br />&lt;body onload="printpr(); return false;"&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /></pre><p>Next, I have a frame with the IE ActiveX control embeded.<br /></p><pre># -*- coding: ISO-8859-1 -*-<br /># generated by wxGlade 0.4.1 on Sun Apr 30 20:43:52 2006<br /><br />import wx<br />import  wx.lib.iewin    as  iewin<br /><br /># begin wxGlade: dependencies<br /># end wxGlade<br /><br />def ieWidget(parent, id):<br />	ie = iewin.IEHtmlWindow(parent, -1)<br />	return ie<br /><br />class dlgIEFrame(wx.Frame):<br />	def __init__(self, *args, **kwds):<br />		# begin wxGlade: dlgIEFrame.__init__<br />		kwds["style"] = wx.DEFAULT_FRAME_STYLE<br />		wx.Frame.__init__(self, *args, **kwds)<br />		self.window_4 = ieWidget(self, -1)<br /><br />		self.__set_properties()<br />		self.__do_layout()<br />		# end wxGlade<br />		self.ie = self.window_4<br />		self.ie.SetClientSizeWH(300, 400)<br /><br />	def __set_properties(self):<br />		# begin wxGlade: dlgIEFrame.__set_properties<br />		self.SetTitle("frame_1")<br />		self.SetSize((792, 755))<br />		# end wxGlade<br /><br />	def __do_layout(self):<br />		# begin wxGlade: dlgIEFrame.__do_layout<br />		sizer_59 = wx.BoxSizer(wx.VERTICAL)<br />		sizer_59.Add(self.window_4, 1, wx.EXPAND, 0)<br />		self.SetAutoLayout(True)<br />		self.SetSizer(sizer_59)<br />		self.Layout()<br />		self.Centre()<br />		# end wxGlade<br /><br /># end of class dlgIEFrame<br /><br /></pre>To display the printing dialog I'm just dumping the generated HTML file to a temporary file and loading it into the IE control. <br />
